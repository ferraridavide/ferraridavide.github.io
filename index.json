[{"content":"Recently, I embarked on a weekend project to create a video compilation of all the intros from the tech show TechLinked (which you can check out here). I figured it wouldn\u0026rsquo;t be too hard and I wouldn\u0026rsquo;t need to write any code, but as it turned out, I ended up having to resort to some Python to get the job done.\nI had my Premiere Pro sequence all set up with all the intros chopped up and ready to go, but when I wanted to add text displaying the name and date of the current clip, I couldn\u0026rsquo;t figure out how to do it in Premiere Pro. I was looking for something similar to After Effects\u0026rsquo; expressions, but unfortunately, this feature is not present in Premiere Pro. I tried everything I could think of, but nada.\nThat\u0026rsquo;s when I had to turn to Python to get the job done. In this blog post, I\u0026rsquo;ll show you how I used Python and Premiere Pro\u0026rsquo;s EDL export feature to make it all happen. This method allows you to quickly and easily add subtitles or captions to your video, without having to manually add them frame by frame.\nHere\u0026rsquo;s what we\u0026rsquo;ll do, we\u0026rsquo;re going to use Premiere Pro\u0026rsquo;s EDL export feature to get a text file with all the necessary information about the cuts in our sequence. Then, we\u0026rsquo;ll use Python to convert that EDL file into an SRT file, a format that Premiere Pro can import as subtitles. If you\u0026rsquo;re unfamiliar with EDL, don\u0026rsquo;t worry – I didn\u0026rsquo;t know what it was before this either. It looks something like this:\nTITLE: [name of the exported sequence] FCM: NON-DROP FRAME 001 AX AA/V C 00:00:00:00 00:00:08:04 00:00:00:00 00:00:08:04 * FROM CLIP NAME: 2022-01-01 [b_s9oeQsNfw].mp4 * AUDIO LEVEL AT 00:00:00:00 IS -0.00 DB (REEL AX A1) * AUDIO LEVEL AT 00:00:00:00 IS -0.00 DB (REEL AX A2) 002 AX AA/V C 00:00:00:00 00:00:11:20 00:00:08:04 00:00:19:24 * FROM CLIP NAME: 2022-01-04 [O8PdzoHyM98].mp4 * AUDIO LEVEL AT 00:00:00:00 IS -0.00 DB (REEL AX A1) * AUDIO LEVEL AT 00:00:00:00 IS -0.00 DB (REEL AX A2) As you can see, it contains information about the edits in the sequence, including the clip name, the start and end timecodes of the clip, and the start and end timecodes of the edit on the timeline.\nAlright, let\u0026rsquo;s get to the code!\nIn Premiere Pro, select the sequence you want to export then go to File \u0026gt; Export \u0026gt; EDL. A dialog will pop up, just press OK and save the EDL file.\nInstall the timecode, edl and srt libraries using pip install timecode edl srt and import them in your Python script\nLet\u0026rsquo;s use the edl library to parse the EDL file.\nparser=edl.Parser(\u0026#39;29.97\u0026#39;) # Set your sequence\u0026#39;s frame rate here with open(\u0026#39;file.edl\u0026#39;) as edl_file: edl=parser.parse(edl_file) events = edl.events This will create a list of Event objects, each representing a single edit in the EDL file.\nIterate through the list of events and create a list of srt.Subtitle objects. By default, the clip_name is the file name of the clip. If you want to display something different in the SRT file, you can create a separate Python function that takes the file name as input and returns the desired text.\ntc = timecode.Timecode(\u0026#39;29.97\u0026#39;) def to_timedelta(time_code): t = tc.parse_timecode(str(time_code)) td = timedelta(hours=t[0], minutes=t[1], seconds=t[2], milliseconds=(t[3]/29.97)*1000) return timedelta(seconds=td.total_seconds()*1.001) def get_text(filename): # Returns the desired text based on the filename return filename subtitles = [] for index, event in enumerate(events, start=1): start_time = to_timedelta(event.rec_start_tc) end_time = to_timedelta(event.rec_end_tc) clip_name = get_text(event.clip_name) subtitles.append(srt.Subtitle(index, start_time, end_time, clip_name)) You may notice that in the to_timedelta function, I\u0026rsquo;m scaling the length of every clip by 1.001, this is a workaround I found as without this, the subtitles wouldn\u0026rsquo;t align properly in the timeline.\nUse the srt library to create the SRT file.\nwith open(\u0026#39;subtitles.srt\u0026#39;, \u0026#39;w\u0026#39;) as srt_file: srt.dump(subtitles, srt_file) And voila! You can now import the .srt file into Premiere Pro and drag in right into your timeline! It should look something like this:\n1 00:00:00,000 --\u0026gt; 00:00:08,141 SSD go brrr 01 January 2022 2 00:00:08,141 --\u0026gt; 00:00:19,820 We thought it wasn\u0026#39;t possible... 04 January 2022 That\u0026rsquo;s it! In my case, every clip filename contained the TechLinked episode\u0026rsquo;s video ID, so i had my get_text function parse the ID using regular expressions, then call YouTube\u0026rsquo;s API to obtain the video title and upload date\nWhile this technique is particularly useful for adding automatic text overlays or subtitles, the possibilities don\u0026rsquo;t stop there. EDL files contain a wealth of information about the edits in your sequence, so you can use this information in many other ways. For example, you could use an EDL file to automatically create YouTube chapters based on the cuts in your sequence.\n","permalink":"https://ferraridavide.github.io/posts/automating-text-premiere-pro/","summary":"Recently, I embarked on a weekend project to create a video compilation of all the intros from the tech show TechLinked (which you can check out here). I figured it wouldn\u0026rsquo;t be too hard and I wouldn\u0026rsquo;t need to write any code, but as it turned out, I ended up having to resort to some Python to get the job done.\nI had my Premiere Pro sequence all set up with all the intros chopped up and ready to go, but when I wanted to add text displaying the name and date of the current clip, I couldn\u0026rsquo;t figure out how to do it in Premiere Pro.","title":"Using Python to automate text overlays in Premiere Pro"},{"content":"One of the reasons that lead me to finally get a Synology NAS was that i needed a simple and reliable way to solve the chaotic photo situation i had going on, all of my and my family’s photos were spread over multiple hard drives and other mediums, scattered in unorganized random folders, to put it simply, they were all over the place.\nI was looking for a solution that is reliable, easily maintainable, and that would allow me to neatly organize all of my photos in a single place, something that has fine-grained control over photo access permissions with a user system, and with an intuitive enough user interface that my tech-illiterate family members could have easy access to our photos.\nOut of all the other options i looked at, like Plex and PhotoPrism, Synology Photo checked almost all of those boxes.\nI took all of the photos from the many hard drives i collected over the years, wrote a script to organize them in a predictable folder structure based on the photo’s metadata (i went with a simple [year]/[month]/[day] structure) and proceeded to dump them all on the NAS\nOnly one thing left to do: separate my private photos from the ones i want to share with my family’s account, i though this would be simple enough, i just organize the photos in albums and then move the albums to the desired location (user’s personal space or shared space), bam, done!\nSadly, as it turns out, the Synology Photo’s web interface and application allow you to move a selection of photos from personal space to shared space only if the selection is made from the timeline or folder view, the option is not available in the album views! Also, moving photos this way wouldn’t preserve the folder structure i made as all the files are moved to the same folder, what a bummer!\nTimeline view selection on the left, Album view selection on the right\nSo let the tinkering begin! In order to move the albums we have to gain access to the Synology Photo’s internal database, query the contents of the album, and then use a script to move the contents automatically to the desired destination\nAccessing Synology DSM internal databases Several of Synology DSM’s services, like Download Station and Synology Photo, run on PostgreSQL databases, there are two main ways to access the data stored in these databases:\nDump the whole database to file with pg_dump then copy and inspect the dump locally (for this, i suggest following this thread) Gain access to the internal PostgreSQL server running in DSM and query the database directly In this guide I’ll show you how to access the database directly, let’s begin!\nGaining access to the internal PostgreSQL server If you haven’t done so already, enable SSH on your Synology NAS by going in Control Panel → Terminal \u0026amp; SNMP → Terminal → Enable SSH service\nIf the firewall is enabled, make sure to open PostgreSQL default port 5432 (TCP)\nUsing the SSH terminal, add this line host all all [Your computer IP address]/32 trust to file /etc/postgresql/pg_hba.conf If your user doesn’t have the necessary permissions to perform this action, run sudo su - postgres It should look something like this:\n# TYPE DATABASE USER ADDRESS METHOD local all postgres peer map=pg_root local all all peer host all all 192.168.1.101/32 trust In /etc/postgresql/postgresql.conf, set this parameter listen_addresses = '*'\nRestart the PostgreSQL server with pg_ctl -m fast restart\nCheck for errors with tail -f /var/log/postgresql.log\nIf everything went well, you should now be able to access the PostgreSQL database with your favorite client! JetBrains DataGrip worked best for me\nExporting Synology Photo albums All that’s left to do is to query the database and extract the album’s photos, I’m going to use JetBrains DataGrip in the following steps, but any other Postgres capable client should be fairly similar\nIn the Database Explorer add a new PostgreSQL Data Source and set these parameters Host: [your Synology NAS IP address]\nAuthentication: User \u0026amp; Password\nUser: postgres\nPassword: [leave blank]\nDatabase: synofoto\nTest the connection and hit Apply\nIn the data source you just created, navigate to synofoto → public → tables, you’ll see the list of all the tables in the Synology Photo database\nRun this query to list every element in every album\nSELECT a.id, a.name as albumName, r.id_item, u.filename, f.name as dirName, CONCAT(f.name,\u0026#39;/\u0026#39;, u.filename) as path FROM public.normal_album AS a JOIN many_item_has_many_normal_album AS r ON a.id = r.id_normal_album JOIN unit AS u ON r.id_item = u.id JOIN folder AS f ON u.id_folder = f.id; You can now export the query result to CSV file! Remember to add column headers, you will need them for your script later\nIn my case, i went for a PowerShell script that reads this CSV file and moves the photos and videos to a new destination\n$data = Import-Csv -Path \u0026#34;[...]\u0026#34; $basepath = \u0026#34;[...]\u0026#34; $dest = \u0026#34;[...]\u0026#34; $data.Where{$_.albumname -eq \u0026#39;[...]\u0026#39;} | ForEach-Object { $fullpath = Join-Path -Path $basepath -ChildPath $_.path Write-Output $fullpath if (Test-Path -Path $fullpath){ $destPath = Join-Path -Path $dest -ChildPath $_.path $destDirectory = Split-Path $destPath if (!(Test-Path $destDirectory)) { New-Item -ItemType Directory -Force -Path $destDirectory } Write-Output \u0026#34;--\u0026gt; $destPath\u0026#34; Move-Item -Path $fullpath -Destination $destPath -WarningAction Inquire -ErrorAction Inquire } } ","permalink":"https://ferraridavide.github.io/posts/accessing-synology-dsm-database/","summary":"One of the reasons that lead me to finally get a Synology NAS was that i needed a simple and reliable way to solve the chaotic photo situation i had going on, all of my and my family’s photos were spread over multiple hard drives and other mediums, scattered in unorganized random folders, to put it simply, they were all over the place.\nI was looking for a solution that is reliable, easily maintainable, and that would allow me to neatly organize all of my photos in a single place, something that has fine-grained control over photo access permissions with a user system, and with an intuitive enough user interface that my tech-illiterate family members could have easy access to our photos.","title":"Accessing Synology DSM internal databases and exporting Synology Photo albums"}]